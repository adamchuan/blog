var $=function(t){var e=document.querySelectorAll(t);if(1===e.length)return e[0];var a=[];return Array.prototype.push.apply(a,e),a};$.throttle=function(t,e,a){var n=null,r=new Date;return function(){if(null===n){var o=new Date;o-r>=a?(r=o,clearTimeout(n),n=null,t()):n=setTimeout(function(){n=null,t()},e)}}},$.ajax=function(t){var e=t.url,a=t.method||"get",n=t.success||function(t){console.log(t)},r=t.error||function(t){console.log(t)},o=("boolean"==typeof t.async?t.async:!0,new XMLHttpRequest);o.onreadystatechange=function(){4===o.readyState&&($.ajax.count--,200==o.status?n(o.responseText):r(o.responseText))},o.open(a,e,!0),o.send()},$.get=function(t,e){$.ajax({url:t,type:"get",success:e})};var uyan_config={title:"自定义网页标题 #微博话题#",url:"自定义网页链接",su:"自定义网页标识"},dom_articles=document.getElementById("articles"),dom_loadding=document.querySelector(".loadingLayer"),article={Map:{},List:[],Tags:{},loaddingTimer:null,loaddingQueue:[],loadingCount:0,TempLate:{summary:$("#t_summary").innerHTML,post:$("#t_post").innerHTML,category:$("#t_category").innerHTML,tags:$("#t_tags").innerHTML,empty:$("#t_empty").innerHTML,loadding:$("#t_loadding").innerHTML},add:function(t,e,a,n,r,o){var i=this,l={url:t,summary:e,category:a,tags:n.split(" "),title:o,date:r,loaded:!1,index:i.List.length};this.Map[l.category]=article.Map[l.category]||[],this.Map[l.category].push(l),l.tags.forEach(function(t){i.Tags[t]=i.Tags[t]||[],i.Tags[t].push(l)}),this.List.push(l)},showLoading:function(t){null===article.loaddingTimer&&(dom_loadding.style.display="block",article.loaddingTimer=setInterval(function(){0===article.loadingCount&&(clearInterval(article.loaddingTimer),article.loaddingTimer=null,dom_loadding.style.display="none","function"==typeof t&&t())},1e3))},loadContent:function(t,e){var a=this.List[t];article.loadingCount++,article.showLoading(),a.loaded?(e(a.html),article.loadingCount--):$.get(a.url,function(t){a.loaded=!0,a.html=t,article.loadingCount--,e(a.html)},"html")},nextpage:function(){},prepage:function(){}},BASE_URL=self.location.host,PAGE_INDEX=1,PAGE_SIZE=5,PAGE_COUNT,PAGE_TYPE,PAGE_LENGTH,router=function(){PAGE_COUNT=article.List.length,PAGE_LENGTH=Math.ceil(PAGE_COUNT/PAGE_SIZE);try{var t=location.href.match(/#.*/gi)[0].replace("#","")}catch(e){t="home"}var a=t.split("_")[0],n=t.split("_")[1]||"";"undefined"==typeof router.handler[a]&&(a="empty"),$(".btn_wrap").forEach(function(t){t.classList.add("hide")}),PAGE_TYPE=a,router.handler[a](n),window.scrollTo(0,0)};$(".btn_prev").addEventListener("click",function(){var t=--PAGE_INDEX;0>=PAGE_INDEX&&(t=PAGE_LENGTH),PAGE_INDEX=t,self.location.hash="#home_"+PAGE_INDEX}),$(".btn_next").addEventListener("click",function(){var t=++PAGE_INDEX;PAGE_INDEX>PAGE_LENGTH&&(t=1),PAGE_INDEX=t,self.location.hash="#home_"+PAGE_INDEX}),router.handler={home:function(t){var e,a="";t=/^-?\d+$/.test(t)?parseInt(t):1,$(".btn_wrap").forEach(function(t){t.classList.remove("hide")}),PAGE_INDEX=t;for(var n=(PAGE_INDEX-1)*PAGE_SIZE;PAGE_INDEX*PAGE_SIZE>n&PAGE_COUNT>n;n++)e=article.List[n],a+=article.TempLate.summary.replace(/__TITLE__/g,e.title).replace(/__HREF__/g,"#post_"+e.index).replace(/__DATE__/g," "+e.date).replace(/__POSTS__/g,e.summary);dom_articles.innerHTML=a},category:function(){var t="";for(var e in article.Map)t+="<dl class='category-container'><dt>"+e+"</dt>",article.Map[e].forEach(function(e){var a="";e.tags.forEach(function(t){a+=article.TempLate.tags.replace(/__HREF__/g,"#tags_"+t).replace(/__TAGS__/g,t)}),t+=article.TempLate.category.replace(/__TITLE__/g,e.title).replace(/__HREF__/g,"#post_"+e.index).replace(/__DATE__/g," "+e.date).replace(/__TAGSCOL__/g,a)}),t+="</dl>";dom_articles.innerHTML=t},work:function(){$.get("works/index.html",function(t){dom_articles.innerHTML=t},"html")},empty:function(){dom_articles.innerHTML=article.TempLate.empty},tags:function(t){var e="<dl class='category-container'><dt>"+t+"</dt>";article.Tags[t].forEach(function(t){var a="";t.tags.forEach(function(t){a+=article.TempLate.tags.replace(/__HREF__/g,"#tags_"+t).replace(/__TAGS__/g,t)}),e+=article.TempLate.category.replace(/__TITLE__/g,t.title).replace(/__HREF__/g,"#post_"+t.index).replace(/__DATE__/g,t.date).replace(/__TAGSCOL__/g,a)}),dom_articles.innerHTML=e},about:function(){$.get("about.html",function(t){dom_articles.innerHTML=t},"html")},post:function(t){var e=article.List[t],a=function(){var a=article.TempLate.post.replace(/__TITLE__/g,e.title).replace(/__HREF__/g,"post_"+t).replace(/__DATE__/g,e.date).replace(/__POSTS__/g,e.summary+e.html);uyan_config.url=e.url,uyan_config.su=t,uyan_config.title=e.title,dom_articles.innerHTML=a;var n=document.createElement("script");n.src="http://v2.uyan.cc/code/uyan.js?uid=1799216",dom_articles.appendChild(n),prettyPrint()};article.loadContent(t,a)}},window.onhashchange=router;